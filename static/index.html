<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>47 EAGLE - Omnichain Liquidity Management</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            width: 100%;
            height: auto;
            min-height: 100%;
            overflow-x: hidden;
            overflow-y: scroll;
        }
        
        body {
            width: 100%;
            height: auto;
            min-height: 100%;
            margin: 0;
            padding: 0;
            background: #000;
            color: white;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            transition: opacity 0.5s ease-out;
        }
        
        body.page-exit {
            opacity: 0;
        }
        
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: 1;
        }
        
        #content {
            position: relative;
            z-index: 10;
        }
        
        .section {
            height: 150vh;
        }
        
        .final-section {
            height: 300vh; /* Much longer to give space after 47 EAGLE */
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .explore-button-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 100;
            opacity: 0;
            transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: none;
        }
        
        .explore-button-container.visible {
            opacity: 1;
            pointer-events: auto;
        }
        
        /* Skip Intro button at the start - centered */
        .skip-intro-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, calc(-50% + 4rem));
            z-index: 100;
            opacity: 1;
            transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .skip-intro-container.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .skip-intro-button {
            padding: 0.65rem 1.75rem;
            font-size: 0.8rem;
            font-weight: 400;
            letter-spacing: 0.1em;
            color: rgba(255, 255, 255, 0.6);
            background: transparent;
            backdrop-filter: none;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: none;
        }
        
        .skip-intro-button:hover {
            color: rgba(255, 255, 255, 0.9);
            border-color: rgba(212, 175, 55, 0.4);
            background: rgba(255, 255, 255, 0.02);
        }
        
        .explore-button {
            padding: 0.875rem 2.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: rgba(255, 255, 255, 0.9);
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .explore-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.1), transparent);
            transition: left 0.6s;
        }
        
        .explore-button:hover {
            color: white;
            border-color: rgba(212, 175, 55, 0.5);
            box-shadow: 0 6px 24px rgba(212, 175, 55, 0.2);
            transform: translateY(-2px);
        }
        
        .explore-button:hover::before {
            left: 100%;
        }
        
        
        .spacer {
            height: 12000px; /* Much longer to pass 47 EAGLE and then reach button */
        }
        
        #loading {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, #000000 0%, #0a0a0a 50%, #000000 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            transition: opacity 1.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        #loading.fade-out {
            opacity: 0;
        }
        
        /* Premium container */
        .vault-container {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
        }
        
        /* Sleek modern progress bar */
        .vault-frame {
            position: relative;
            width: 320px;
            height: 4px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 2px;
            overflow: visible;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
        }
        
        /* Liquid progress fill */
        .vault-liquid {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 0%;
            background: linear-gradient(90deg, 
                rgba(212, 175, 55, 0.6),
                rgba(212, 175, 55, 0.8),
                rgba(212, 175, 55, 0.6));
            background-size: 200% 100%;
            border-radius: 2px;
            transition: width 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 0 15px rgba(212, 175, 55, 0.4),
                0 0 30px rgba(212, 175, 55, 0.2);
            animation: shimmer-flow 2s linear infinite;
        }
        
        @keyframes shimmer-flow {
            0% { background-position: 0% 50%; }
            100% { background-position: 200% 50%; }
        }
        
        /* Logo above progress */
        .vault-logo {
            width: 60px;
            height: 60px;
            margin-bottom: 1rem;
            opacity: 0.85;
            filter: drop-shadow(0 4px 12px rgba(212, 175, 55, 0.2));
        }
        
        /* Remove vault rings and lock - cleaner design */
        .vault-ring,
        .vault-lock {
            display: none;
        }
        
        #loading-percentage {
            font-size: 3.5rem;
            font-weight: 200;
            letter-spacing: 0.6rem;
            color: white;
            font-variant-numeric: tabular-nums;
            margin-bottom: 0.5rem;
        }
        
        #loading-label {
            font-size: 0.7rem;
            font-weight: 400;
            letter-spacing: 0.4rem;
            color: rgba(255, 255, 255, 0.3);
            text-transform: uppercase;
            margin-top: 1.5rem;
        }
    </style>
</head>
<body>
    <div id="loading">
        <div class="vault-container">
            <img src="https://tomato-abundant-urial-204.mypinata.cloud/ipfs/bafybeigzyatm2pgrkqbnskyvflnagtqli6rgh7wv7t2znaywkm2pixmkxy" 
                 alt="47 EAGLE" 
                 class="vault-logo" />
            <div id="loading-percentage">0%</div>
            <div class="vault-frame">
                <div class="vault-liquid" id="vault-liquid"></div>
            </div>
            <div id="loading-label">Initializing</div>
        </div>
    </div>
    
    <!-- Fixed button that appears at the end -->
    <div class="explore-button-container" id="explore-button-container">
        <button class="explore-button" onclick="navigateToPage('/user')">
            Explore Docs
        </button>
    </div>
    
    <!-- Skip Intro button at the start -->
    <div class="skip-intro-container" id="skip-intro-container">
        <button class="skip-intro-button" id="skip-intro-button">
            Skip Intro
        </button>
    </div>
    
    <div id="canvas-container"></div>
    
    <div id="content">
        <!-- Extended sections for complete tunnel journey -->
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        
        <!-- Empty sections for scroll height -->
        <div class="final-section"></div>
        <div class="spacer"></div>
    </div>
    
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
        }
    }
    </script>
    
    <script type="module">
        import * as THREE from 'three';
        import { FontLoader } from 'three/addons/loaders/FontLoader.js';
        import { TextGeometry } from 'three/addons/geometries/TextGeometry.js';
        
        
        {
            // Vault filling animation
            let progress = 0;
            
            const loadingInterval = setInterval(() => {
                progress += 1;
                
                // Update percentage text
                document.getElementById('loading-percentage').textContent = progress + '%';
                
                // Fill progress bar with golden liquid
                document.getElementById('vault-liquid').style.width = progress + '%';
                
                if (progress >= 100) {
                    clearInterval(loadingInterval);
                    
                    // Fade out loading screen
                    setTimeout(() => {
                        document.getElementById('loading').classList.add('fade-out');
                        
                        // Remove loading screen after fade
                        setTimeout(() => {
                            document.getElementById('loading').style.display = 'none';
                            initTunnel();
                        }, 1500);
                    }, 300);
                }
            }, 20);
        }
        
        function initTunnel() {
            try {
                
                // Scene setup
                const scene = new THREE.Scene();
                scene.background = new THREE.Color(0x000000);
                scene.fog = new THREE.Fog(0x000000, 5, 15);
                
                const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                camera.position.set(0, 0, 5);
                
                const renderer = new THREE.WebGLRenderer({ antialias: true });
                renderer.setSize(window.innerWidth, window.innerHeight);
                renderer.setPixelRatio(window.devicePixelRatio);
                document.getElementById('canvas-container').appendChild(renderer.domElement);
                
                
                // Lights
                scene.add(new THREE.AmbientLight(0xffffff, 0.5));
                const light1 = new THREE.PointLight(0xffffff, 1, 0);
                light1.position.set(10, 10, 10);
                scene.add(light1);
                const light2 = new THREE.PointLight(0xffffff, 0.5, 0);
                light2.position.set(-10, -10, -10);
                scene.add(light2);
                
                // Create tunnel
                const tunnelGroup = new THREE.Group();
                scene.add(tunnelGroup);
                
                
                // Tunnel segments
                for (let i = 0; i < 240; i++) {
                    const geometry = new THREE.CylinderGeometry(4.5, 4.6, 1.5, 32, 1, true);
                    const material = new THREE.MeshPhongMaterial({
                        color: 0xffffff,
                        wireframe: true,
                        transparent: true,
                        opacity: 0.25, // More elegant transparency
                        shininess: 100,
                        specular: 0xffffff,
                        emissive: 0xd4af37, // Golden emissive
                        emissiveIntensity: 0.1, // Subtle golden glow
                        side: THREE.DoubleSide,
                        depthWrite: false
                    });
                    const mesh = new THREE.Mesh(geometry, material);
                    mesh.position.set(0, 0, -i * 0.7);
                    mesh.rotation.x = Math.PI / 2;
                    tunnelGroup.add(mesh);
                }
                
                
                // Stars
                for (let i = 0; i < 200; i++) {
                    const radius = 6 + Math.random() * 4;
                    const angle = Math.random() * Math.PI * 2;
                    const x = Math.cos(angle) * radius;
                    const y = Math.sin(angle) * radius;
                    const z = -Math.random() * 150;
                    
                    const starGeometry = new THREE.SphereGeometry(0.02, 4, 4);
                    const starMaterial = new THREE.MeshBasicMaterial({
                        color: 0xffffff,
                        transparent: true,
                        opacity: 0.8
                    });
                    const star = new THREE.Mesh(starGeometry, starMaterial);
                    star.position.set(x, y, z);
                    tunnelGroup.add(star);
                }
                
                
                // Create a separate group for text (doesn't rotate with tunnel)
                const textGroup = new THREE.Group();
                scene.add(textGroup);
                
                // Load helvetiker font and create REAL 3D text like goddog
                const loader = new FontLoader();
                loader.load('/fonts/helvetiker_regular.typeface.json', (font) => {
                    
                    const textSections = [
                        { text: 'WLFI', z: -30 },
                        { text: 'USD1', z: -55 },
                        { text: 'UNISWAP V3', z: -80 },
                        { text: 'LAYERZERO V2', z: -105 },
                        { text: 'ERC-4626', z: -130 },
                        { text: 'ONE VAULT', z: -155 },
                        { text: 'INFINITE CHAINS', z: -180 },
                        { text: 'INTRODUCING', z: -205 },
                        { text: '47 EAGLE', z: -230 }
                    ];
                    
                    textSections.forEach(({ text, z }) => {
                        // Goddog exact settings: size=1.5, height=0.2, curveSegments=12
                        const textGeometry = new TextGeometry(text, {
                            font: font,
                            size: 1.5, // Same size for all text
                            height: 0.2,
                            curveSegments: 12
                        });
                        
                        // Center the geometry
                        textGeometry.center();
                        
                        // Simple white text with minimal golden tint
                        const textMaterial = new THREE.MeshPhongMaterial({
                            color: 0xffffff,
                            emissive: 0xffffee, // Very slight warm tint
                            emissiveIntensity: 0.3, // Subtle base glow
                            shininess: 100,
                            transparent: true,
                            opacity: 1,
                            depthWrite: true
                        });
                        
                        // Create text mesh
                        const textMesh = new THREE.Mesh(textGeometry, textMaterial);
                        textMesh.position.set(0, 0, z);
                        textMesh.userData.material = textMaterial;
                        textMesh.userData.isText = true;
                        textGroup.add(textMesh);
                        
                    });
                    
                });
                
                // Add elegant "Scroll to begin" hint
                const scrollHintCanvas = document.createElement('canvas');
                const scrollHintCtx = scrollHintCanvas.getContext('2d');
                scrollHintCanvas.width = 1536;
                scrollHintCanvas.height = 256;
                
                scrollHintCtx.fillStyle = 'rgba(0, 0, 0, 0)';
                scrollHintCtx.fillRect(0, 0, scrollHintCanvas.width, scrollHintCanvas.height);
                
                // Ultra-light, elegant font - smaller and more refined
                scrollHintCtx.font = '300 38px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                scrollHintCtx.textAlign = 'center';
                scrollHintCtx.textBaseline = 'middle';
                scrollHintCtx.letterSpacing = '0.2em';
                
                const centerX = scrollHintCanvas.width / 2;
                const centerY = scrollHintCanvas.height / 2;
                
                // Very subtle glow
                scrollHintCtx.shadowColor = 'rgba(255, 255, 255, 0.3)';
                scrollHintCtx.shadowBlur = 25;
                scrollHintCtx.fillStyle = 'rgba(255, 255, 255, 0.7)';
                scrollHintCtx.fillText('SCROLL TO BEGIN', centerX, centerY);
                
                // Crisp white layer
                scrollHintCtx.shadowBlur = 8;
                scrollHintCtx.fillStyle = 'rgba(255, 255, 255, 0.9)';
                scrollHintCtx.fillText('SCROLL TO BEGIN', centerX, centerY);
                
                const scrollHintTexture = new THREE.CanvasTexture(scrollHintCanvas);
                const scrollHintMaterial = new THREE.SpriteMaterial({ 
                    map: scrollHintTexture,
                    transparent: true,
                    opacity: 0 // Start invisible
                });
                const scrollHintSprite = new THREE.Sprite(scrollHintMaterial);
                scrollHintSprite.scale.set(5, 0.83, 1); // Smaller, more delicate
                scrollHintSprite.position.set(0, -0.5, 3); // Just below center
                tunnelGroup.add(scrollHintSprite);
                
                let scrollHintOpacity = 0; // Start at 0
                let hasScrolled = false;
                let introFadeInComplete = false;
                
                // Scroll tracking
                let scrollValue = 0;
                let scrollRefCurrent = 0;
                let targetCameraZ = 0;
                
                // Update loop
                function animate() {
                    requestAnimationFrame(animate);
                    
                    // Smooth scroll interpolation - higher value = smoother but slower
                    scrollRefCurrent += (scrollValue - scrollRefCurrent) * 0.08;
                    
                    // Camera movement - EXTRA slow for comfortable reading
                    targetCameraZ = 5 - (scrollRefCurrent * 0.002); // Even slower - 0.002
                    camera.position.z += (targetCameraZ - camera.position.z) * 0.08; // Smoother interpolation
                    
                    // Tunnel rotation
                    tunnelGroup.rotation.z = scrollRefCurrent * 0.0001;
                    tunnelGroup.rotation.y = Math.sin(Date.now() * 0.00015) * 0.005;
                    
                    // Handle scroll hint fade in/out
                    if (scrollValue > 10 && !hasScrolled) {
                        hasScrolled = true;
                    }
                    
                    if (!hasScrolled) {
                        // Fade in slowly
                        scrollHintOpacity += (1 - scrollHintOpacity) * 0.02;
                        if (scrollHintOpacity > 0.95) {
                            introFadeInComplete = true;
                        }
                    } else {
                        // Fade out when user scrolls
                        scrollHintOpacity += (0 - scrollHintOpacity) * 0.1;
                    }
                    scrollHintSprite.material.opacity = scrollHintOpacity;
                    
                    // Fade text with MUCH LONGER visibility range so text is readable
                    textGroup.children.forEach((child) => {
                        if (child.userData && child.userData.isText) {
                            const distance = Math.abs(camera.position.z - child.position.z);
                            const visibilityRange = 20;
                            const fadeStart = 8;
                            
                            let targetOpacity = 0;
                            if (distance < fadeStart) {
                                targetOpacity = 1;
                            } else if (distance < visibilityRange) {
                                const fadeProgress = (distance - fadeStart) / (visibilityRange - fadeStart);
                                targetOpacity = Math.pow(1 - fadeProgress, 2);
                            }
                            
                            if (child.userData.material) {
                                child.userData.material.opacity = targetOpacity;
                                // Add subtle golden glow when close
                                child.userData.material.emissiveIntensity = 0.3 + (targetOpacity * 1.5);
                            }
                            child.visible = targetOpacity > 0.01;
                        }
                    });
                    
                    // Show button when camera passes 47 EAGLE and you continue scrolling
                    const buttonContainer = document.getElementById('explore-button-container');
                    
                    // Calculate scroll progress
                    const maxScroll = document.documentElement.scrollHeight - window.innerHeight;
                    const scrollProgress = scrollValue / maxScroll;
                    
                    // Show button when 90% scrolled AND camera has passed -220
                    if (scrollProgress > 0.90 && camera.position.z < -220) {
                        buttonContainer.classList.add('visible');
                    } else {
                        buttonContainer.classList.remove('visible');
                    }
                    
                    
                    renderer.render(scene, camera);
                }
                
                // Scroll listener
                window.addEventListener('scroll', () => {
                    scrollValue = window.scrollY || window.pageYOffset || document.documentElement.scrollTop;
                }, { passive: true });
                
                
                // Handle resize
                window.addEventListener('resize', () => {
                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(window.innerWidth, window.innerHeight);
                });
                
                
                // Skip Intro button functionality - go straight to docs
                document.getElementById('skip-intro-button').addEventListener('click', () => {
                    navigateToPage('/user');
                });
                
                // Smooth page transition function
                function navigateToPage(url) {
                    document.body.classList.add('page-exit');
                    setTimeout(() => {
                        window.location.href = url;
                    }, 500);
                }
                
                // Hide Skip Intro button after scrolling starts
                let hideSkipButton = false;
                setInterval(() => {
                    if (scrollValue > 100 && !hideSkipButton) {
                        hideSkipButton = true;
                        document.getElementById('skip-intro-container').classList.add('hidden');
                    }
                }, 500);
                
                // Start
                animate();
                
            } catch (error) {
                console.error('Error initializing tunnel:', error);
                document.getElementById('loading').innerHTML = 'Error: ' + error.message;
            }
        }
    </script>
</body>
</html>
