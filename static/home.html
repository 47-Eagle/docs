<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>47 EAGLE - Omnichain Liquidity Management</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html {
            width: 100%;
            height: auto;
            min-height: 100%;
            overflow-x: hidden;
            overflow-y: scroll;
        }
        
        body {
            width: 100%;
            height: auto;
            min-height: 100%;
            margin: 0;
            padding: 0;
            background: #000;
            color: white;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            transition: opacity 0.5s ease-out;
        }
        
        /* Light mode support */
        @media (prefers-color-scheme: light) {
            body {
                background: #ffffff;
                color: #0a0a0a;
            }
            
            #loading {
                background: linear-gradient(135deg, #fafafa 0%, #f5f5f5 50%, #fafafa 100%);
            }
            
            #loading-percentage,
            #loading-label {
                color: #0a0a0a;
            }
            
            #loading-label {
                color: rgba(0, 0, 0, 0.4);
            }
            
            .vault-frame {
                background: rgba(0, 0, 0, 0.05);
            }
            
            .explore-button,
            .skip-intro-button {
                color: rgba(0, 0, 0, 0.8);
                background: rgba(0, 0, 0, 0.03);
                border-color: rgba(212, 175, 55, 0.4);
            }
            
            .explore-button:hover,
            .skip-intro-button:hover {
                color: #0a0a0a;
                background: rgba(0, 0, 0, 0.05);
                border-color: rgba(212, 175, 55, 0.6);
            }
        }
        
        body.page-exit {
            opacity: 0;
        }
        
        #canvas-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100vh;
            z-index: 1;
        }
        
        #content {
            position: relative;
            z-index: 10;
        }
        
        .section {
            height: 150vh;
        }
        
        .final-section {
            height: 300vh; /* Much longer to give space after 47 EAGLE */
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }
        
        .explore-button-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 100;
            opacity: 0;
            transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: none;
        }
        
        .explore-button-container.visible {
            opacity: 1;
            pointer-events: auto;
        }
        
        /* Skip Intro button at the start - centered */
        .skip-intro-container {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, calc(-50% + 4rem));
            z-index: 100;
            opacity: 1;
            transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .skip-intro-container.hidden {
            opacity: 0;
            pointer-events: none;
        }
        
        .skip-intro-button {
            padding: 0.65rem 1.75rem;
            font-size: 0.8rem;
            font-weight: 400;
            letter-spacing: 0.1em;
            color: rgba(255, 255, 255, 0.6);
            background: transparent;
            backdrop-filter: none;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: none;
        }
        
        .skip-intro-button:hover {
            color: rgba(255, 255, 255, 0.9);
            border-color: rgba(212, 175, 55, 0.4);
            background: rgba(255, 255, 255, 0.02);
        }
        
        .explore-button {
            padding: 0.875rem 2.5rem;
            font-size: 0.875rem;
            font-weight: 500;
            letter-spacing: 0.15em;
            text-transform: uppercase;
            color: rgba(255, 255, 255, 0.9);
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(212, 175, 55, 0.3);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .explore-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(212, 175, 55, 0.1), transparent);
            transition: left 0.6s;
        }
        
        .explore-button:hover {
            color: white;
            border-color: rgba(212, 175, 55, 0.5);
            box-shadow: 0 6px 24px rgba(212, 175, 55, 0.2);
            transform: translateY(-2px);
        }
        
        .explore-button:hover::before {
            left: 100%;
        }
        
        
        .spacer {
            height: 12000px; /* Much longer to pass 47 EAGLE and then reach button */
        }
        
        #loading {
            position: fixed;
            inset: 0;
            background: linear-gradient(135deg, #000000 0%, #0a0a0a 50%, #000000 100%);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            transition: opacity 1.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        #loading.fade-out {
            opacity: 0;
        }
        
        /* Premium container */
        .vault-container {
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
        }
        
        /* Sleek modern progress bar */
        .vault-frame {
            position: relative;
            width: 320px;
            height: 4px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 2px;
            overflow: visible;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.3);
        }
        
        /* Liquid progress fill */
        .vault-liquid {
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 0%;
            background: linear-gradient(90deg, 
                rgba(212, 175, 55, 0.6),
                rgba(212, 175, 55, 0.8),
                rgba(212, 175, 55, 0.6));
            background-size: 200% 100%;
            border-radius: 2px;
            transition: width 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 0 15px rgba(212, 175, 55, 0.4),
                0 0 30px rgba(212, 175, 55, 0.2);
            animation: shimmer-flow 2s linear infinite;
        }
        
        @keyframes shimmer-flow {
            0% { background-position: 0% 50%; }
            100% { background-position: 200% 50%; }
        }
        
        /* Logo above progress */
        .vault-logo {
            width: 60px;
            height: 60px;
            margin-bottom: 1rem;
            opacity: 0.85;
            filter: drop-shadow(0 4px 12px rgba(212, 175, 55, 0.2));
        }
        
        /* Remove vault rings and lock - cleaner design */
        .vault-ring,
        .vault-lock {
            display: none;
        }
        
        #loading-percentage {
            font-size: 3.5rem;
            font-weight: 200;
            letter-spacing: 0.6rem;
            color: white;
            font-variant-numeric: tabular-nums;
            margin-bottom: 0.5rem;
        }
        
        #loading-label {
            font-size: 0.7rem;
            font-weight: 400;
            letter-spacing: 0.4rem;
            color: rgba(255, 255, 255, 0.3);
            text-transform: uppercase;
            margin-top: 1.5rem;
        }
        
        /* ================================
           MOBILE RESPONSIVE STYLES
           ================================ */
        
        @media (max-width: 768px) {
            /* Loading screen adjustments */
            #loading-percentage {
                font-size: 2.5rem;
                letter-spacing: 0.4rem;
            }
            
            #loading-label {
                font-size: 0.6rem;
                letter-spacing: 0.3rem;
            }
            
            .vault-frame {
                width: 240px;
                height: 3px;
            }
            
            .vault-logo {
                width: 48px;
                height: 48px;
            }
            
            /* Button adjustments for touch targets */
            .explore-button {
                padding: 1rem 2rem;
                font-size: 0.8rem;
                min-height: 48px; /* iOS minimum touch target */
            }
            
            .skip-intro-button {
                padding: 0.75rem 1.5rem;
                font-size: 0.75rem;
                min-height: 44px;
            }
            
            .skip-intro-container {
                transform: translate(-50%, calc(-50% + 3rem));
            }
            
            /* Adjust scroll sections for mobile */
            .section {
                height: 120vh;
            }
            
            .final-section {
                height: 250vh;
            }
            
            .spacer {
                height: 10000px;
            }
        }
        
        @media (max-width: 480px) {
            /* Extra small mobile adjustments */
            #loading-percentage {
                font-size: 2rem;
                letter-spacing: 0.3rem;
            }
            
            #loading-label {
                font-size: 0.55rem;
                letter-spacing: 0.25rem;
            }
            
            .vault-frame {
                width: 200px;
                height: 3px;
            }
            
            .vault-logo {
                width: 40px;
                height: 40px;
            }
            
            .explore-button {
                padding: 0.875rem 1.5rem;
                font-size: 0.75rem;
                letter-spacing: 0.12em;
            }
            
            .skip-intro-button {
                padding: 0.65rem 1.25rem;
                font-size: 0.7rem;
                letter-spacing: 0.08em;
            }
        }
        
        /* Touch device optimizations */
        @media (hover: none) and (pointer: coarse) {
            /* Increase tap areas on touch devices */
            .explore-button,
            .skip-intro-button {
                min-height: 48px;
                min-width: 120px;
            }
            
            /* Remove hover effects on touch devices */
            .explore-button:hover,
            .skip-intro-button:hover {
                transform: none;
            }
            
            /* Add active state for touch feedback */
            .explore-button:active,
            .skip-intro-button:active {
                transform: scale(0.98);
                opacity: 0.9;
            }
        }
        
        /* ================================
           AUDIO CONTROLS - TOP RIGHT
           ================================ */
        
        .audio-controls {
            position: fixed;
            top: 1.5rem;
            right: 1.5rem;
            z-index: 10000;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            padding: 0.75rem 1rem;
            background: rgba(255, 255, 255, 0.03);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(212, 175, 55, 0.2);
            border-radius: 50px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 0;
            animation: fadeInControls 1s ease-out 2s forwards;
        }
        
        @keyframes fadeInControls {
            to { opacity: 1; }
        }
        
        .audio-controls:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(212, 175, 55, 0.3);
            box-shadow: 0 4px 20px rgba(212, 175, 55, 0.15);
        }
        
        .audio-btn {
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.7);
            cursor: pointer;
            padding: 0.25rem;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s ease;
            width: 28px;
            height: 28px;
        }
        
        .audio-btn:hover {
            color: rgba(212, 175, 55, 0.9);
            transform: scale(1.1);
        }
        
        .audio-btn:active {
            transform: scale(0.95);
        }
        
        .audio-btn svg {
            width: 18px;
            height: 18px;
        }
        
        .volume-slider {
            width: 60px;
            height: 3px;
            -webkit-appearance: none;
            appearance: none;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 3px;
            outline: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .volume-slider:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        
        .volume-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 12px;
            height: 12px;
            background: #d4af37;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .volume-slider::-webkit-slider-thumb:hover {
            background: #e2c55f;
            transform: scale(1.2);
        }
        
        .volume-slider::-moz-range-thumb {
            width: 12px;
            height: 12px;
            background: #d4af37;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .volume-slider::-moz-range-thumb:hover {
            background: #e2c55f;
            transform: scale(1.2);
        }
        
        .audio-divider {
            width: 1px;
            height: 20px;
            background: rgba(255, 255, 255, 0.1);
        }
        
        /* Light mode audio controls */
        @media (prefers-color-scheme: light) {
            .audio-controls {
                background: rgba(0, 0, 0, 0.03);
                border-color: rgba(212, 175, 55, 0.3);
            }
            
            .audio-controls:hover {
                background: rgba(0, 0, 0, 0.05);
                border-color: rgba(212, 175, 55, 0.5);
            }
            
            .audio-btn {
                color: rgba(0, 0, 0, 0.6);
            }
            
            .audio-btn:hover {
                color: rgba(212, 175, 55, 1);
            }
            
            .volume-slider {
                background: rgba(0, 0, 0, 0.1);
            }
            
            .volume-slider:hover {
                background: rgba(0, 0, 0, 0.15);
            }
            
            .audio-divider {
                background: rgba(0, 0, 0, 0.1);
            }
        }
        
        /* Mobile audio controls */
        @media (max-width: 768px) {
            .audio-controls {
                top: 1rem;
                right: 1rem;
                padding: 0.6rem 0.8rem;
                gap: 0.5rem;
            }
            
            .audio-btn {
                width: 24px;
                height: 24px;
            }
            
            .audio-btn svg {
                width: 16px;
                height: 16px;
            }
            
            .volume-slider {
                width: 50px;
            }
        }
    </style>
</head>
<body>
    <div id="loading">
        <div class="vault-container">
            <img src="https://tomato-abundant-urial-204.mypinata.cloud/ipfs/bafybeigzyatm2pgrkqbnskyvflnagtqli6rgh7wv7t2znaywkm2pixmkxy" 
                 alt="47 EAGLE" 
                 class="vault-logo" />
            <div id="loading-percentage">0%</div>
            <div class="vault-frame">
                <div class="vault-liquid" id="vault-liquid"></div>
            </div>
            <div id="loading-label">Initializing</div>
        </div>
    </div>
    
    <!-- Fixed button that appears at the end -->
    <div class="explore-button-container" id="explore-button-container">
        <button class="explore-button" id="explore-docs-button">
            Explore Docs
        </button>
    </div>
    
    <!-- Skip Intro button at the start -->
    <div class="skip-intro-container" id="skip-intro-container">
        <button class="skip-intro-button" id="skip-intro-button">
            Skip Intro
        </button>
    </div>
    
    <!-- Audio Controls -->
    <div class="audio-controls" id="audio-controls">
        <button class="audio-btn" id="play-pause-btn" title="Play/Pause">
            <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polygon points="5 3 19 12 5 21 5 3"></polygon>
            </svg>
            <svg id="pause-icon" style="display: none;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <rect x="6" y="4" width="4" height="16"></rect>
                <rect x="14" y="4" width="4" height="16"></rect>
            </svg>
        </button>
        
        <div class="audio-divider"></div>
        
        <button class="audio-btn" id="volume-btn" title="Mute/Unmute">
            <svg id="volume-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                <path d="M15.54 8.46a5 5 0 0 1 0 7.07"></path>
                <path d="M19.07 4.93a10 10 0 0 1 0 14.14"></path>
            </svg>
            <svg id="mute-icon" style="display: none;" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polygon points="11 5 6 9 2 9 2 15 6 15 11 19 11 5"></polygon>
                <line x1="23" y1="9" x2="17" y2="15"></line>
                <line x1="17" y1="9" x2="23" y2="15"></line>
            </svg>
        </button>
        
        <input type="range" class="volume-slider" id="volume-slider" min="0" max="100" value="70" title="Volume">
    </div>
    
    <!-- Background Audio -->
    <audio id="background-audio" loop preload="auto">
        <source src="/Winter (Four Seasons).mp3" type="audio/mpeg">
    </audio>
    
    <div id="canvas-container"></div>
    
    <div id="content">
        <!-- Extended sections for complete tunnel journey -->
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        <div class="section"></div>
        
        <!-- Empty sections for scroll height -->
        <div class="final-section"></div>
        <div class="spacer"></div>
    </div>
    
    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.160.0/examples/jsm/"
        }
    }
    </script>
    
    <script type="module">
        import * as THREE from 'three';
        import { FontLoader } from 'three/addons/loaders/FontLoader.js';
        import { TextGeometry } from 'three/addons/geometries/TextGeometry.js';
        
        // ========================================
        // AUDIO SYSTEM WITH FADE-IN
        // ========================================
        const audio = document.getElementById('background-audio');
        const playPauseBtn = document.getElementById('play-pause-btn');
        const playIcon = document.getElementById('play-icon');
        const pauseIcon = document.getElementById('pause-icon');
        const volumeBtn = document.getElementById('volume-btn');
        const volumeIcon = document.getElementById('volume-icon');
        const muteIcon = document.getElementById('mute-icon');
        const volumeSlider = document.getElementById('volume-slider');
        
        let isMuted = false;
        let previousVolume = 0.7;
        
        // Set initial volume (70%)
        audio.volume = 0;
        volumeSlider.value = 70;
        
        // Fade-in function
        function fadeInAudio() {
            const targetVolume = volumeSlider.value / 100;
            const fadeStep = targetVolume / 100; // 100 steps
            let currentVol = 0;
            
            const fadeInterval = setInterval(() => {
                if (currentVol < targetVolume) {
                    currentVol += fadeStep;
                    audio.volume = Math.min(currentVol, targetVolume);
                } else {
                    clearInterval(fadeInterval);
                }
            }, 30); // 3 seconds total fade-in
        }
        
        // Track if audio has started
        let audioStarted = false;
        
        // Function to start audio with fade-in
        function startAudio() {
            if (audioStarted) return;
            
            audio.play().then(() => {
                audioStarted = true;
                fadeInAudio();
                playIcon.style.display = 'none';
                pauseIcon.style.display = 'block';
            }).catch(err => {
                console.log('Autoplay blocked, waiting for user interaction');
            });
        }
        
        // Try to start immediately
        startAudio();
        
        // If blocked, start on ANY user interaction
        const tryAutoplay = () => {
            if (!audioStarted) {
                startAudio();
                // Remove listeners after first successful play
                if (audioStarted) {
                    document.removeEventListener('click', tryAutoplay);
                    document.removeEventListener('touchstart', tryAutoplay);
                    document.removeEventListener('keydown', tryAutoplay);
                    document.removeEventListener('scroll', tryAutoplay);
                }
            }
        };
        
        document.addEventListener('click', tryAutoplay);
        document.addEventListener('touchstart', tryAutoplay);
        document.addEventListener('keydown', tryAutoplay);
        document.addEventListener('scroll', tryAutoplay);
        
        // Play/Pause button
        playPauseBtn.addEventListener('click', () => {
            if (audio.paused) {
                audio.play();
                playIcon.style.display = 'none';
                pauseIcon.style.display = 'block';
            } else {
                audio.pause();
                playIcon.style.display = 'block';
                pauseIcon.style.display = 'none';
            }
        });
        
        // Mute/Unmute button
        volumeBtn.addEventListener('click', () => {
            if (isMuted) {
                audio.volume = previousVolume;
                volumeSlider.value = previousVolume * 100;
                volumeIcon.style.display = 'block';
                muteIcon.style.display = 'none';
                isMuted = false;
            } else {
                previousVolume = audio.volume;
                audio.volume = 0;
                volumeIcon.style.display = 'none';
                muteIcon.style.display = 'block';
                isMuted = true;
            }
        });
        
        // Volume slider
        volumeSlider.addEventListener('input', (e) => {
            const volume = e.target.value / 100;
            audio.volume = volume;
            
            if (volume === 0) {
                volumeIcon.style.display = 'none';
                muteIcon.style.display = 'block';
                isMuted = true;
            } else {
                volumeIcon.style.display = 'block';
                muteIcon.style.display = 'none';
                isMuted = false;
                previousVolume = volume;
            }
        });
        
        // ========================================
        // LOADING ANIMATION
        // ========================================
        {
            // Vault filling animation
            let progress = 0;
            
            const loadingInterval = setInterval(() => {
                progress += 1;
                
                // Update percentage text
                document.getElementById('loading-percentage').textContent = progress + '%';
                
                // Fill progress bar with golden liquid
                document.getElementById('vault-liquid').style.width = progress + '%';
                
                if (progress >= 100) {
                    clearInterval(loadingInterval);
                    
                    // Fade out loading screen
                    setTimeout(() => {
                        document.getElementById('loading').classList.add('fade-out');
                        
                        // Remove loading screen after fade
                        setTimeout(() => {
                            document.getElementById('loading').style.display = 'none';
                            initTunnel();
                        }, 1500);
                    }, 300);
                }
            }, 20);
        }
        
        function initTunnel() {
            try {
                // Detect mobile and light mode
                const isMobile = window.innerWidth <= 768;
                const isLightMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches;
                
                // Scene setup
                const scene = new THREE.Scene();
                const bgColor = isLightMode ? 0xfafafa : 0x000000;
                scene.background = new THREE.Color(bgColor);
                scene.fog = new THREE.Fog(bgColor, 5, 15);
                
                const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
                camera.position.set(0, 0, 5);
                
                const renderer = new THREE.WebGLRenderer({ antialias: true });
                renderer.setSize(window.innerWidth, window.innerHeight);
                renderer.setPixelRatio(window.devicePixelRatio);
                document.getElementById('canvas-container').appendChild(renderer.domElement);
                
                
                // Lights
                scene.add(new THREE.AmbientLight(0xffffff, 0.5));
                const light1 = new THREE.PointLight(0xffffff, 1, 0);
                light1.position.set(10, 10, 10);
                scene.add(light1);
                const light2 = new THREE.PointLight(0xffffff, 0.5, 0);
                light2.position.set(-10, -10, -10);
                scene.add(light2);
                
                // Create tunnel
                const tunnelGroup = new THREE.Group();
                scene.add(tunnelGroup);
                
                
                // Tunnel segments (fewer on mobile for performance)
                const segmentCount = isMobile ? 180 : 240;
                const segmentQuality = isMobile ? 24 : 32;
                
                for (let i = 0; i < segmentCount; i++) {
                    const geometry = new THREE.CylinderGeometry(4.5, 4.6, 1.5, segmentQuality, 1, true);
                    const material = new THREE.MeshPhongMaterial({
                        color: isLightMode ? 0x0a0a0a : 0xffffff,
                        wireframe: true,
                        transparent: true,
                        opacity: isLightMode ? 0.15 : 0.25,
                        shininess: 100,
                        specular: isLightMode ? 0x0a0a0a : 0xffffff,
                        emissive: 0xd4af37, // Golden emissive
                        emissiveIntensity: 0.1, // Subtle golden glow
                        side: THREE.DoubleSide,
                        depthWrite: false
                    });
                    const mesh = new THREE.Mesh(geometry, material);
                    mesh.position.set(0, 0, -i * 0.7);
                    mesh.rotation.x = Math.PI / 2;
                    tunnelGroup.add(mesh);
                }
                
                
                // Stars (fewer on mobile for performance)
                const starCount = isMobile ? 100 : 200;
                for (let i = 0; i < starCount; i++) {
                    const radius = 6 + Math.random() * 4;
                    const angle = Math.random() * Math.PI * 2;
                    const x = Math.cos(angle) * radius;
                    const y = Math.sin(angle) * radius;
                    const z = -Math.random() * 150;
                    
                    const starGeometry = new THREE.SphereGeometry(0.02, 4, 4);
                    const starMaterial = new THREE.MeshBasicMaterial({
                        color: isLightMode ? 0xd4af37 : 0xffffff,
                        transparent: true,
                        opacity: isLightMode ? 0.6 : 0.8
                    });
                    const star = new THREE.Mesh(starGeometry, starMaterial);
                    star.position.set(x, y, z);
                    tunnelGroup.add(star);
                }
                
                
                // Create a separate group for text (doesn't rotate with tunnel)
                const textGroup = new THREE.Group();
                scene.add(textGroup);
                
                // Load helvetiker font and create REAL 3D text like goddog
                const loader = new FontLoader();
                loader.load('/fonts/helvetiker_regular.typeface.json', (font) => {
                    
                    const textSections = [
                        { text: 'WLFI', z: -30 },
                        { text: 'USD1', z: -55 },
                        { text: 'UNISWAP V3', z: -80 },
                        { text: 'LAYERZERO V2', z: -105 },
                        { text: 'ERC-4626', z: -130 },
                        { text: 'ONE VAULT', z: -155 },
                        { text: 'INFINITE CHAINS', z: -180 },
                        { text: 'INTRODUCING', z: -205 },
                        { text: '47 EAGLE', z: -230 }
                    ];
                    
                    textSections.forEach(({ text, z }) => {
                        // Goddog exact settings: size=1.5, height=0.2, curveSegments=12
                        // Smaller on mobile for better fit
                        const textSize = isMobile ? 1.0 : 1.5;
                        const textHeight = isMobile ? 0.15 : 0.2;
                        
                        const textGeometry = new TextGeometry(text, {
                            font: font,
                            size: 1.5, // Same size for all text
                            height: 0.2,
                            curveSegments: 12
                        });
                        
                        // Center the geometry
                        textGeometry.center();
                        
                        // Simple white text with minimal golden tint
                        const textMaterial = new THREE.MeshPhongMaterial({
                            color: 0xffffff,
                            emissive: 0xffffee, // Very slight warm tint
                            emissiveIntensity: 0.3, // Subtle base glow
                            shininess: 100,
                            transparent: true,
                            opacity: 1,
                            depthWrite: true
                        });
                        
                        // Create text mesh
                        const textMesh = new THREE.Mesh(textGeometry, textMaterial);
                        textMesh.position.set(0, 0, z);
                        textMesh.userData.material = textMaterial;
                        textMesh.userData.isText = true;
                        textGroup.add(textMesh);
                        
                    });
                    
                });
                
                // Add elegant "Scroll to begin" hint
                const scrollHintCanvas = document.createElement('canvas');
                const scrollHintCtx = scrollHintCanvas.getContext('2d');
                scrollHintCanvas.width = 1536;
                scrollHintCanvas.height = 256;
                
                scrollHintCtx.fillStyle = 'rgba(0, 0, 0, 0)';
                scrollHintCtx.fillRect(0, 0, scrollHintCanvas.width, scrollHintCanvas.height);
                
                // Ultra-light, elegant font - smaller and more refined
                scrollHintCtx.font = '300 38px -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
                scrollHintCtx.textAlign = 'center';
                scrollHintCtx.textBaseline = 'middle';
                scrollHintCtx.letterSpacing = '0.2em';
                
                const centerX = scrollHintCanvas.width / 2;
                const centerY = scrollHintCanvas.height / 2;
                
                // Very subtle glow
                scrollHintCtx.shadowColor = 'rgba(255, 255, 255, 0.3)';
                scrollHintCtx.shadowBlur = 25;
                scrollHintCtx.fillStyle = 'rgba(255, 255, 255, 0.7)';
                scrollHintCtx.fillText('SCROLL TO BEGIN', centerX, centerY);
                
                // Crisp white layer
                scrollHintCtx.shadowBlur = 8;
                scrollHintCtx.fillStyle = 'rgba(255, 255, 255, 0.9)';
                scrollHintCtx.fillText('SCROLL TO BEGIN', centerX, centerY);
                
                const scrollHintTexture = new THREE.CanvasTexture(scrollHintCanvas);
                const scrollHintMaterial = new THREE.SpriteMaterial({ 
                    map: scrollHintTexture,
                    transparent: true,
                    opacity: 0 // Start invisible
                });
                const scrollHintSprite = new THREE.Sprite(scrollHintMaterial);
                scrollHintSprite.scale.set(5, 0.83, 1); // Smaller, more delicate
                scrollHintSprite.position.set(0, -0.5, 3); // Just below center
                tunnelGroup.add(scrollHintSprite);
                
                let scrollHintOpacity = 0; // Start at 0
                let hasScrolled = false;
                let introFadeInComplete = false;
                
                // Scroll tracking
                let scrollValue = 0;
                let scrollRefCurrent = 0;
                let targetCameraZ = 0;
                
                // Update loop
                function animate() {
                    requestAnimationFrame(animate);
                    
                    // Smooth scroll interpolation - higher value = smoother but slower
                    scrollRefCurrent += (scrollValue - scrollRefCurrent) * 0.08;
                    
                    // Camera movement - EXTRA slow for comfortable reading
                    targetCameraZ = 5 - (scrollRefCurrent * 0.002); // Even slower - 0.002
                    camera.position.z += (targetCameraZ - camera.position.z) * 0.08; // Smoother interpolation
                    
                    // Tunnel rotation
                    tunnelGroup.rotation.z = scrollRefCurrent * 0.0001;
                    tunnelGroup.rotation.y = Math.sin(Date.now() * 0.00015) * 0.005;
                    
                    // Handle scroll hint fade in/out
                    if (scrollValue > 10 && !hasScrolled) {
                        hasScrolled = true;
                    }
                    
                    if (!hasScrolled) {
                        // Fade in slowly
                        scrollHintOpacity += (1 - scrollHintOpacity) * 0.02;
                        if (scrollHintOpacity > 0.95) {
                            introFadeInComplete = true;
                        }
                    } else {
                        // Fade out when user scrolls
                        scrollHintOpacity += (0 - scrollHintOpacity) * 0.1;
                    }
                    scrollHintSprite.material.opacity = scrollHintOpacity;
                    
                    // Fade text with MUCH LONGER visibility range so text is readable
                    textGroup.children.forEach((child) => {
                        if (child.userData && child.userData.isText) {
                            const distance = Math.abs(camera.position.z - child.position.z);
                            const visibilityRange = 20;
                            const fadeStart = 8;
                            
                            let targetOpacity = 0;
                            if (distance < fadeStart) {
                                targetOpacity = 1;
                            } else if (distance < visibilityRange) {
                                const fadeProgress = (distance - fadeStart) / (visibilityRange - fadeStart);
                                targetOpacity = Math.pow(1 - fadeProgress, 2);
                            }
                            
                            if (child.userData.material) {
                                child.userData.material.opacity = targetOpacity;
                                // Add subtle golden glow when close
                                child.userData.material.emissiveIntensity = 0.3 + (targetOpacity * 1.5);
                            }
                            child.visible = targetOpacity > 0.01;
                        }
                    });
                    
                    // Show button when camera passes 47 EAGLE and you continue scrolling
                    const buttonContainer = document.getElementById('explore-button-container');
                    
                    // Calculate scroll progress
                    const maxScroll = document.documentElement.scrollHeight - window.innerHeight;
                    const scrollProgress = scrollValue / maxScroll;
                    
                    // Show button when 90% scrolled AND camera has passed -220
                    if (scrollProgress > 0.90 && camera.position.z < -220) {
                        buttonContainer.classList.add('visible');
                    } else {
                        buttonContainer.classList.remove('visible');
                    }
                    
                    
                    renderer.render(scene, camera);
                }
                
                // Scroll listener
                window.addEventListener('scroll', () => {
                    scrollValue = window.scrollY || window.pageYOffset || document.documentElement.scrollTop;
                }, { passive: true });
                
                
                // Handle resize
                window.addEventListener('resize', () => {
                    camera.aspect = window.innerWidth / window.innerHeight;
                    camera.updateProjectionMatrix();
                    renderer.setSize(window.innerWidth, window.innerHeight);
                });
                
                
                // Smooth page transition function
                function navigateToPage(url) {
                    document.body.classList.add('page-exit');
                    setTimeout(() => {
                        window.location.href = url;
                    }, 500);
                }
                
                // Skip Intro button functionality - go straight to docs
                document.getElementById('skip-intro-button').addEventListener('click', () => {
                    navigateToPage('/user');
                });
                
                // Explore Docs button functionality
                document.getElementById('explore-docs-button').addEventListener('click', () => {
                    navigateToPage('/user');
                });
                
                // Hide Skip Intro button after scrolling starts
                let hideSkipButton = false;
                setInterval(() => {
                    if (scrollValue > 100 && !hideSkipButton) {
                        hideSkipButton = true;
                        document.getElementById('skip-intro-container').classList.add('hidden');
                    }
                }, 500);
                
                // Start
                animate();
                
            } catch (error) {
                console.error('Error initializing tunnel:', error);
                document.getElementById('loading').innerHTML = 'Error: ' + error.message;
            }
        }
    </script>
</body>
</html>
